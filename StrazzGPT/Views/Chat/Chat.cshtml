@{
    ViewData["Title"] = "Chat";
}
<head>
    <link rel="stylesheet" href="~/css/chat.css" asp-append-version="true" />
</head>
<body>
    <div class="chat-container">
        <div id="chatOutput" class="output"></div>
        <form id="promptForm" class="input-form">
            <textarea id="promptInput" placeholder="Ask Strazz a Question..." required></textarea>
            <button type="submit">Send</button>
        </form>
    </div>
</body>


<script>
    document.getElementById('promptInput').addEventListener('input', function () {
        this.style.height = 'auto'; // Reset the height
        this.style.height = (this.scrollHeight) + 'px'; // Set the height equal to the scroll height
    });

    document.getElementById('promptForm').addEventListener('submit', function (event) {
        event.preventDefault();
        const inputField = document.getElementById('promptInput');
        const prompt = inputField.value;
        inputField.value = ''; // Clear the input after sending
        inputField.style.height = '50px'; // Reset the height after submit

        // Display user message
        const userMessage = document.createElement('div');
        userMessage.className = 'message user-message';
        userMessage.textContent = prompt;
        document.getElementById('chatOutput').appendChild(userMessage);

        fetch('/Chat/GetChatResponse', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ prompt: prompt })
        })
            .then(response => response.json())
            .then(data => {
                // Display bot response
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot-message';
                botMessage.textContent = data.message;
                document.getElementById('chatOutput').appendChild(botMessage);
            })
            .catch(error => {
                console.error('Fetch error:', error);
                const errorMessage = document.createElement('div');
                errorMessage.className = 'message error-message';
                errorMessage.textContent = 'Error fetching response';
                document.getElementById('chatOutput').appendChild(errorMessage);
            });
    });
</script>